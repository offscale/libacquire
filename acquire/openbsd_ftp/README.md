Taken from the OpenBSD codebase at
commit 8ccc394472c04770d6b419b298c71feb8a152a24
Date:   Sat Sep 4 16:26:12 2021 +0000


Intention: socket based solution valid on any OS, without additional dependencies.